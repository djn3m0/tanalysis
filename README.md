
 <td id="wikicontent" class="psdescription">
 <p></p><ul><li><a href="#Overview">Overview</a></li>
 <li><a href="#Installing">Installing</a></li>
 <ul><li><a href="#Prerequisites">Prerequisites</a></li>
 <li><a href="#Installing_STAC">Installing STAC</a></li>
 <li><a href="#Uninstalling_STAC">Uninstalling STAC</a></li>
 </ul><li><a href="#Running_the_analysis">Running the analysis</a></li>
 <li><a href="#Simple_Example">Simple Example</a></li>
 <li><a href="#Taint_Dependency_Sequences_-_TDS">Taint Dependency Sequences - TDS</a></li>
 <li><a href="#Characterizing_Vulnerability_Activation_Inputs">Characterizing Vulnerability Activation Inputs</a></li>
 </ul> <p></p><h1><a name="Overview"></a>Overview<a href="#Overview" class="section_anchor"></a></h1>
 <p>In the context of vulnerability detection, we present an approach for characterizing the execution paths which may lead to exploitable vulnerabilities. 
 In order to do this, we propose a sound taint analysis calculus which also encompasses a taint dependency sequence (TDS) calculus, making explicit the sequences 
 of control and data dependencies which must be met in order for a variable to become tainted. </p><p>We extend the analysis previously performed 
 <a href="https://code.google.com/p/tanalysis/wiki/STACv1">here</a> 
 by dealing with all the possible kinds of dependencies: data and control flow (both positive and negative). </p>
 <h1><a name="Installing"></a>Installing<a href="#Installing" class="section_anchor"></a></h1>
 <h2><a name="Prerequisites"></a>Prerequisites<a href="#Prerequisites" class="section_anchor"></a></h2>
 <p>The tool has been built as a plug-in for the <a href="http://www.frama-c.com/" rel="nofollow">Frama-C</a> platform, therefore the main prerequisite is Frama-C itself.
 Instructions for downloading and installing Frama-C can be found  <a href="http://www.frama-c.com/download.html" rel="nofollow">here</a>. </p><h2>
 <a name="Installing_STAC"></a>Installing STAC<a href="#Installing_STAC" class="section_anchor"></a></h2><ol><li>The sources can be downloaded from
 <a href="" rel="nofollow">here</a>. <strong>TODO</strong> </li><li>In the source folder run: </li><pre class="prettyprint"><span class="pln">make </span>
 <span class="pun">&amp;&amp;</span><span class="pln"> make install</span></pre></ol><h2><a name="Uninstalling_STAC"></a>Uninstalling STAC
 <a href="#Uninstalling_STAC" class="section_anchor"></a></h2><ol><li>In the source folder run: </li><pre class="prettyprint"><span class="pln">make uninstall</span></pre></ol><h1><a name="Running_the_analysis"></a>Running the analysis<a href="https://code.google.com/p/tanalysis/#Running_the_analysis" class="section_anchor"></a></h1><p>In order to run Frama-C on a set of C input files use the following command:  </p><pre class="prettyprint"><span class="pln">frama</span><span class="pun">-</span><span class="pln">c </span><span class="pun">[</span><span class="pln">options</span><span class="pun">]</span><span class="pln"> </span><span class="pun">[</span><span class="pln">source_files</span><span class="pun">]</span></pre><p>The full set of options for the STAC plug-in can be obtained when running: </p><pre class="prettyprint"><span class="pln">frama</span><span class="pun">-</span><span class="pln">c </span><span class="pun">-</span><span class="pln">STAC</span><span class="pun">-</span><span class="pln">help</span></pre><p>The options include: </p><ul><li><strong>-taint-analysis</strong> enables the taintness and TDS computation for the given files. </li><li><strong>-disable-alias</strong> disables the <a href="http://cms.dc.uba.ar/materias/aap/2008/c2/descargas/pointsTo.pdf" rel="nofollow">may-alias</a> computation performed in the preprocessing phase. </li><li><strong>-tds <tt>&lt;</tt>sid<tt>&gt;</tt></strong> pretty prints the TDS associated to a statement in the program. The statement is specified by using the statement id (sid) assigned by Frama-C. </li><li><strong>-print-prg</strong> pretty prints the program while adding the statement ids as comments in the source. This is a way of finding out the ids of the statements we are interested in before using the <strong>-tds</strong> option. </li><li><strong>-no-filename</strong> by default, STAC prints the elements of the TDS as pairs (source_file, line). However, if the analyzed program consists only of one source file, we can suppress printing its name through this option. </li><li><strong>-tds-metrics <tt>&lt;</tt>metric<tt>&gt;</tt></strong> applies the given metric when outputting the TDS. For now, the metric names and implementations are hardcoded in STAC. The possible values are: </li><ul><li><strong>no-loop</strong> filters out the TDS which correspond to more than one loop iterations </li><li><strong>pure-data</strong> filters out the TDS which contain control dependencies </li><li><strong>control</strong> filters out the "pure-data" TDS </li><li><strong>pure-control</strong> keeps the TDS which end in a control dependency chain and this is the only control dependency chain in the TDS </li></ul><li><strong>-translate-vulnerable</strong> this option is conditioned by the use of the <strong>-taint-analysis</strong> flag. It finds all the statements in the program which correspond to possibly unsafe memory operations (for the moment, a simple pattern of the form <i>a buffer access to a tainted buffer or with a tainted index</i> is used). For each possibly vulnerable statement, a new annotated C file is generated in order to be further analyzed as we will show later. </li></ul><p></p><h1><a name="Simple_Example"></a>Simple Example<a href="https://code.google.com/p/tanalysis/#Simple_Example" class="section_anchor"></a></h1><p>Let's take a look at the following simple example. Let's call it <tt>test.c</tt>: </p><pre class="prettyprint"><span class="pln">&nbsp;</span><span class="lit">1</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> input</span><span class="pun">()</span><span class="pln"><br>&nbsp;</span><span class="lit">2</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp;</span><span class="lit">3</span><span class="pln"> &nbsp; </span><span class="kwd">int</span><span class="pln"> taint </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"><br>&nbsp;</span><span class="lit">4</span><span class="pln"> &nbsp; </span><span class="kwd">int</span><span class="pln"> result </span><span class="pun">=</span><span class="pln"> taint</span><span class="pun">;</span><span class="pln"><br>&nbsp;</span><span class="lit">5</span><span class="pln"> &nbsp; </span><span class="kwd">return</span><span class="pln"> result</span><span class="pun">;</span><span class="pln"><br>&nbsp;</span><span class="lit">6</span><span class="pln"> </span><span class="pun">}</span><span class="pln"><br>&nbsp;</span><span class="lit">7</span><span class="pln"> <br>&nbsp;</span><span class="lit">8</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> main</span><span class="pun">()</span><span class="pln"><br>&nbsp;</span><span class="lit">9</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br></span><span class="lit">10</span><span class="pln"> &nbsp; </span><span class="kwd">int</span><span class="pln"> x</span><span class="pun">,</span><span class="pln"> y</span><span class="pun">,</span><span class="pln"> z</span><span class="pun">,</span><span class="pln"> buf</span><span class="pun">[</span><span class="lit">42</span><span class="pun">];</span><span class="pln"><br></span><span class="lit">11</span><span class="pln"> &nbsp; x </span><span class="pun">=</span><span class="pln"> </span><span class="lit">200</span><span class="pun">;</span><span class="pln"><br></span><span class="lit">12</span><span class="pln"> &nbsp; y </span><span class="pun">=</span><span class="pln"> input</span><span class="pun">();</span><span class="pln"><br></span><span class="lit">13</span><span class="pln"> &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">x </span><span class="pun">&gt;</span><span class="pln"> y</span><span class="pun">)</span><span class="pln"><br></span><span class="lit">14</span><span class="pln"> &nbsp; &nbsp; z </span><span class="pun">=</span><span class="pln"> y </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"><br></span><span class="lit">15</span><span class="pln"> &nbsp; </span><span class="kwd">else</span><span class="pln"><br></span><span class="lit">16</span><span class="pln"> &nbsp; &nbsp; z </span><span class="pun">=</span><span class="pln"> input</span><span class="pun">();</span><span class="pln"><br></span><span class="lit">17</span><span class="pln"> &nbsp; buf</span><span class="pun">[</span><span class="pln">z</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">128</span><span class="pun">;</span><span class="pln"><br></span><span class="lit">18</span><span class="pln"> &nbsp; </span><span class="kwd">return</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span><span class="pln"><br></span><span class="lit">19</span><span class="pln"> </span><span class="pun">}</span></pre><p>We use here the custom function <tt>input()</tt> in order to denote a user-supplied input. The function uses the local variable <tt>taint</tt> in order to denote a tainted variable. For the moment, we have chosen this hardcoded approach just to create a prototype implementation. In a nicer implementation, the inputs should be specified with the help of a config file. </p><p>The <tt>main()</tt> function reads a user supplied value for <tt>y</tt> and based on it and <tt>x</tt> sets the value of <tt>z</tt> (either to <tt>20</tt> or to another user supplied value). Therefore, if we compute a taint analysis, we would reach the conclusion that <tt>z</tt> is tainted at the end of the main function. This is not really interesting as we don't really know why <tt>z</tt> is tainted. Is it because of the value of <tt>y</tt>? Is it because of the user supplied value for <tt>z</tt>? Is it because the user may choose which branch of the condition to take? </p><h1><a name="Taint_Dependency_Sequences_-_TDS"></a>Taint Dependency Sequences - TDS<a href="https://code.google.com/p/tanalysis/#Taint_Dependency_Sequences_-_TDS" class="section_anchor"></a></h1><p>A TDS associated to a variable will represent a sequence of labels which, if executed in this order, may allow the user to control the value of the variable.  </p><p>In the previous example, a possible TDS is <tt>&lt;</tt>4,12,14<tt>&gt;</tt>. This corresponds to executing the <tt>input()</tt> function call at line 12 which in turn taints its returned value at line 4 and then assign the returned value to <tt>y</tt>. This value is then used for computing the value of <tt>z</tt> at line 14. </p><p>Let's take a look at the results obtained when using STAC. We begin by deciding on a program point on which we want to focus. We have chosen line 17. We need to find the statement id associated to line 17 so we run: </p><pre class="prettyprint"><span class="pln">frama</span><span class="pun">-</span><span class="pln">c </span><span class="pun">-</span><span class="kwd">print</span><span class="pun">-</span><span class="pln">prg test</span><span class="pun">.</span><span class="pln">c</span></pre><p>and we get a program annotated with the sids. We are interested in the following part: </p><pre class="prettyprint"><span class="pln">&nbsp; </span><span class="com">/* sid:22 */</span><span class="pln"><br>&nbsp; buf</span><span class="pun">[</span><span class="pln">z</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="lit">128</span><span class="pun">;</span></pre><p>which corresponds to the buffer access at line 17. Therefore the sid computed by Frama-C is 21. We now perform the TDS calculus and print the TDS computed for statement 21 (at line 17): </p><pre class="prettyprint"><span class="pln">frama</span><span class="pun">-</span><span class="pln">c </span><span class="pun">-</span><span class="pln">taint</span><span class="pun">-</span><span class="pln">analysis </span><span class="pun">-</span><span class="kwd">no</span><span class="pun">-</span><span class="pln">filename </span><span class="pun">-</span><span class="pln">tds </span><span class="lit">21</span><span class="pln"> test</span><span class="pun">.</span><span class="pln">c</span></pre><p>We get the following set of TDS: </p><pre class="prettyprint"><span class="pln">y</span><span class="pun">:{</span><span class="pln"><br>&nbsp; </span><span class="pun">[(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">4</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">12</span><span class="pun">))]</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br>z</span><span class="pun">:{</span><span class="pln"><br>&nbsp; </span><span class="pun">[(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">4</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">16</span><span class="pun">))],</span><span class="pln"><br>&nbsp; </span><span class="pun">[(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">4</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">12</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">14</span><span class="pun">))],</span><span class="pln"><br>&nbsp; </span><span class="pun">[(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">4</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">12</span><span class="pun">))(</span><span class="pln">CF</span><span class="pun">:(</span><span class="lit">13</span><span class="pun">))]</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br>buf</span><span class="pun">:{</span><span class="pln"><br>&nbsp; </span><span class="pun">[(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">4</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">16</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">17</span><span class="pun">))],</span><span class="pln"><br>&nbsp; </span><span class="pun">[(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">4</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">12</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">14</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">17</span><span class="pun">))],</span><span class="pln"><br>&nbsp; </span><span class="pun">[(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">4</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">12</span><span class="pun">))(</span><span class="pln">CF</span><span class="pun">:(</span><span class="lit">13</span><span class="pun">))(</span><span class="pln">DF</span><span class="pun">:(</span><span class="lit">17</span><span class="pun">))]</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br>__retres</span><span class="pun">:{}</span><span class="pln"><br>x</span><span class="pun">:{}</span></pre><p>If we take a closer look at the TDS associated to <tt>z</tt> we will notice that the TDS we used as an example is there (<tt>&lt;</tt>4,12,14<tt>&gt;</tt>). However, this isn't the only way of tainting <tt>z</tt>. We notice that <tt>z</tt> could be also tainted because of being directly assigned some user supplied value (<tt>&lt;</tt>4,16<tt>&gt;</tt>) or because the assignment which sets <tt>z</tt> can be chosen with the help of <tt>y</tt> which is tainted (<tt>&lt;</tt>4,12,14<tt>&gt;</tt>). As an additional remark, the <tt>DF</tt> and <tt>CF</tt> attributes in the TDS correspond to data dependency and control dependencies respectively. </p><p>Well, this was just a small example. More complex examples can be found on the <a href="https://code.google.com/p/tanalysis/wiki/tdsexamples">TDS examples</a> page. </p><h1><a name="Characterizing_Vulnerability_Activation_Inputs"></a>Characterizing Vulnerability Activation Inputs<a href="#Characterizing_Vulnerability_Activation_Inputs" class="section_anchor"></a></h1><p><strong>TODO</strong> </p><p><img src="./tanalysis - STAC - Static Taint Analysis for C - Google Project Hosting_files/jessie_general_approach.jpeg" width="75%"> </p>
 </td>
 </tr>
</tbody></table>
<script src="./tanalysis - STAC - Static Taint Analysis for C - Google Project Hosting_files/prettify_core_compiled.js"></script>
<script type="text/javascript">
 prettyPrint();
</script>

 
 
 
 <script type="text/javascript" src="./tanalysis - STAC - Static Taint Analysis for C - Google Project Hosting_files/ph_core.js"></script>
 
 
 
 
</div> 

<div id="footer" dir="ltr">
 <div class="text">
 <a href="https://code.google.com/projecthosting/terms.html">Terms</a> -
 <a href="http://www.google.com/privacy.html">Privacy</a> -
 <a href="https://code.google.com/p/support/">Project Hosting Help</a>
 </div>
</div>
 <div class="hostedBy" style="margin-top: -20px;">
 <span style="vertical-align: top;">Powered by <a href="http://code.google.com/projecthosting/">Google Project Hosting</a></span>
 </div>

 
 


 
 


<div class="menuDiv instance0" id="menuDiv-projects-dropdown" style="position: absolute; top: 18px; left: 976px; display: none;"><div class="menuCategory default" style="display: none;"></div><div class="menuCategory controls first"><a class="menuItem" href="http://www.google.com/accounts/ServiceLogin?service=code&ltmpl=phosting&continue=https%3A%2F%2Fcode.google.com%2Fp%2Ftanalysis%2F&amp;followup=https%3A%2F%2Fcode.google.com%2Fp%2Ftanalysis%2F" style="display: block;">Sign in to see your favorites</a><hr class="menuSeparator"><a class="menuItem" href="https://code.google.com/hosting/" style="display: block;">Find open source projects...</a>
<a class="menuItem" href="https://code.google.com/hosting/createProject" style="display: block;">Create a project...</a></div></div></body></html>
